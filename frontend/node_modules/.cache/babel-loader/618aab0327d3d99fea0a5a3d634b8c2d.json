{"remainingRequest":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/babel-loader/lib/index.js!/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/src/components/Post.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/src/components/Post.vue","mtime":1627995886643},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEFwaVNlcnZpY2UgZnJvbSAiLi4vYXBpLXNlcnZpY2UiOwoKdmFyIG1vbWVudCA9IHJlcXVpcmUoIm1vbWVudCIpOwoKbW9tZW50LmxvY2FsZSgiZnIiKTsgLy9BcHBlbCBkdSBtb2R1bGUgbW9tZW50LmpzIHBvdXIgYWZmaWNoYWdlIMOgIHF1ZWwgbW9tZW50IGxlIG1lc3NhZ2UgYSDDqXTDqSDDqWNyaXMKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUG9zdCIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVycm9yOiBbXSwKICAgICAgdXNlcklkOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIiksCiAgICAgIGlzQWRtaW46IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpc0FkbWluIiksCiAgICAgIG1vbWVudDogbW9tZW50LAogICAgICBwb3N0czogW10sCiAgICAgIGNvbW1lbnRzOiB7fSwKICAgICAgc2hvd0NvbW1lbnRzOiB7fSwKICAgICAgbWVzc2FnZTogIiIKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyBTdXBwcmVzc2lvbiBkJ3VuIHBvc3QKICAgIHJlbW92ZVBvc3Q6IGZ1bmN0aW9uIHJlbW92ZVBvc3QocG9zdCkgewogICAgICBpZiAoY29uZmlybSgiw4p0ZXMgdm91cyBzw7tyIGRlIHZvdWxvaXIgc3VwcHJpbWVyIGxlIHBvc3QgPyIpKSB7CiAgICAgICAgQXBpU2VydmljZS5yZW1vdmVQb3N0KHBvc3QpOwogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSwKICAgIC8vIEFmZmljaGFnZSBkZXMgY29tbWVudGFpcmVzIGxpw6lzIGF1IHBvc3QKICAgIHNob3dDb21tZW50c0FjdGlvbjogZnVuY3Rpb24gc2hvd0NvbW1lbnRzQWN0aW9uKHBvc3QpIHsKICAgICAgdGhpcy5zaG93Q29tbWVudHNbcG9zdC5wb3N0X2lkXSA9ICF0aGlzLnNob3dDb21tZW50c1twb3N0LnBvc3RfaWRdOwogICAgICB0aGlzLnNob3dDb21tZW50cyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5zaG93Q29tbWVudHMpKTsKICAgIH0sCiAgICBzZW5kQ29tbWVudDogZnVuY3Rpb24gc2VuZENvbW1lbnQocG9zdElkKSB7CiAgICAgIHZhciBtZXNzYWdlID0gdGhpcy5tZXNzYWdlOwogICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTsKICAgICAgY29uc29sZS5sb2cocG9zdElkKTsKICAgICAgQXBpU2VydmljZS5jcmVhdGVDb21tZW50KG1lc3NhZ2UsIHBvc3RJZCk7CiAgICAgIHRoaXMubWVzc2FnZSA9ICIiOwogICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgIH0sCiAgICByZW1vdmVDb21tZW50OiBmdW5jdGlvbiByZW1vdmVDb21tZW50KGNvbW1lbnQpIHsKICAgICAgaWYgKGNvbmZpcm0oIsOKdGVzIHZvdXMgc8O7ciBkZSB2b3Vsb2lyIHN1cHByaW1lciBsZSBjb21tZW50YWlyZSA/IikpIHsKICAgICAgICBBcGlTZXJ2aWNlLnJlbW92ZUNvbW1lbnQoY29tbWVudCk7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAvL0FwcGVsIMOgIEFQSSBwb3VyIGFmZmljaGFnZSBkZSB0b3VzIGxlcyBtZXNzYWdlcwogICAgQXBpU2VydmljZS5nZXRBbGxQb3N0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXMucG9zdHMgPSByZXNwb25zZS5kYXRhOwogICAgICBjb25zb2xlLmxvZyhfdGhpcy5wb3N0cyk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgIH0pOwogICAgQXBpU2VydmljZS5nZXRBbGxDb21tZW50KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXMuY29tbWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgICBjb25zb2xlLmxvZyhfdGhpcy5jb21tZW50cyk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgIH0pOwogIH0KfTs="},{"version":3,"sources":["Post.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkGA,OAAA,UAAA,MAAA,gBAAA;;AAEA,IAAA,MAAA,GAAA,OAAA,CAAA,QAAA,CAAA;;AACA,MAAA,CAAA,MAAA,CAAA,IAAA,E,CAAA;;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,MADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,MAAA,EAAA,YAAA,CAAA,OAAA,CAAA,QAAA,CAFA;AAGA,MAAA,OAAA,EAAA,YAAA,CAAA,OAAA,CAAA,SAAA,CAHA;AAIA,MAAA,MAAA,EAAA,MAJA;AAKA,MAAA,KAAA,EAAA,EALA;AAMA,MAAA,QAAA,EAAA,EANA;AAOA,MAAA,YAAA,EAAA,EAPA;AAQA,MAAA,OAAA,EAAA;AARA,KAAA;AAUA,GAbA;AAcA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,UAFA,sBAEA,IAFA,EAEA;AACA,UAAA,OAAA,CAAA,8CAAA,CAAA,EAAA;AACA,QAAA,UAAA,CAAA,UAAA,CAAA,IAAA;AACA,QAAA,QAAA,CAAA,MAAA;AACA,OAHA,MAGA;AACA;AACA;AACA,KATA;AAUA;AACA,IAAA,kBAXA,8BAWA,IAXA,EAWA;AACA,WAAA,YAAA,CAAA,IAAA,CAAA,OAAA,IAAA,CAAA,KAAA,YAAA,CAAA,IAAA,CAAA,OAAA,CAAA;AACA,WAAA,YAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,KAAA,YAAA,CAAA,CAAA;AACA,KAdA;AAeA,IAAA,WAfA,uBAeA,MAfA,EAeA;AACA,UAAA,OAAA,GAAA,KAAA,OAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,OAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,MAAA;AACA,MAAA,UAAA,CAAA,aAAA,CAAA,OAAA,EAAA,MAAA;AACA,WAAA,OAAA,GAAA,EAAA;AACA,MAAA,QAAA,CAAA,MAAA;AACA,KAtBA;AAuBA,IAAA,aAvBA,yBAuBA,OAvBA,EAuBA;AACA,UAAA,OAAA,CAAA,qDAAA,CAAA,EAAA;AACA,QAAA,UAAA,CAAA,aAAA,CAAA,OAAA;AACA,QAAA,QAAA,CAAA,MAAA;AACA,OAHA,MAGA;AACA;AACA;AACA;AA9BA,GAdA;AA8CA,EAAA,OA9CA,qBA8CA;AAAA;;AACA;AACA,IAAA,UAAA,CAAA,UAAA,GACA,IADA,CACA,UAAA,QAAA,EAAA;AACA,MAAA,KAAA,CAAA,KAAA,GAAA,QAAA,CAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,KAAA;AACA,KAJA,EAKA,KALA,CAKA,UAAA,KAAA;AAAA,aAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA;AAAA,KALA;AAMA,IAAA,UAAA,CAAA,aAAA,GACA,IADA,CACA,UAAA,QAAA,EAAA;AACA,MAAA,KAAA,CAAA,QAAA,GAAA,QAAA,CAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,QAAA;AACA,KAJA,EAKA,KALA,CAKA,UAAA,KAAA;AAAA,aAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA;AAAA,KALA;AAMA;AA5DA,CAAA","sourcesContent":["<template>\n  <section class=\"post\">\n    <!--AFFICHAGE DES POSTS-->\n    <div class=\"post_title\">\n      <font-awesome-icon icon=\"newspaper\" class=\"post_title--icon\" />\n      <h2 class=\"post_title--text\">Fil d'actualités</h2>\n    </div>\n\n    <div class=\"post_item\" v-for=\"post in posts\" :key=\"post.id\">\n      <div class=\"post_item--content\">\n        <div class=\"post_header\">\n          <font-awesome-icon icon=\"user\" class=\"post_header--icon\" />\n          <h3 class=\"post_header--username\">{{ post.author.username }}</h3>\n          <div class=\"post_header--date\">\n            <div class=\"post_header--date-logo\">\n              <font-awesome-icon icon=\"history\" />\n            </div>\n            <p class=\"post_header--date-content date\">\n              {{ moment(post.date).fromNow() }}\n            </p>\n          </div>\n\n          <button\n            type=\"button\"\n            title=\"Supprimer cette publication\"\n            class=\"post_header--btn\"\n            v-if=\"post.user_id == userId || isAdmin == 'ADMIN'\"\n            @click=\"removePost(post)\"\n          >\n            <font-awesome-icon icon=\"trash-alt\" />\n          </button>\n        </div>\n\n        <h4 class=\"post_item--content-title\">{{ post.titre }}</h4>\n        <img\n          class=\"post_item--content-img\"\n          v-if=\"post.imageUrl != ''\"\n          :src=\"post.imageUrl\"\n          :alt=\"post.titre\"\n        />\n        <p class=\"post_item--content-txt\">{{ post.content }}</p>\n        <button\n          class=\"post_item--content-btn\"\n          v-if=\"post.comments.length >= 1\"\n          @click=\"showCommentsAction(post)\"\n        >\n          <font-awesome-icon icon=\"comment\" />\n          Commentaires - {{ post.comments.length }}\n        </button>\n        <div class=\"comments_wrapper\" v-if=\"showComments[post.post_id]\">\n          <div\n            class=\"comments_wrapper--items\"\n            v-for=\"comment in comments\"\n            :key=\"comment.postId\"\n          >\n            <div class=\"comment_item\" v-if=\"post.post_id == comment.post_id\">\n              <div class=\"comment\">\n                <div class=\"comment_header\">\n                  <h6 class=\"comment_header--username\">\n                    {{ comment.username }}\n                  </h6>\n                  <div class=\"comment_header--date\">\n                    <p class=\"date\">{{ moment(comment.date).fromNow() }}</p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    title=\"Supprimer ce commentaire\"\n                    class=\"comment_header--remove-btn\"\n                    v-if=\"comment.user_id == userId || isAdmin == 'ADMIN'\"\n                    @click=\"removeComment(comment)\"\n                  >\n                    <font-awesome-icon icon=\"trash-alt\" />\n                  </button>\n                </div>\n                <p class=\"comment_content\">{{ comment.message }}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <form class=\"comment_new\" @submit.prevent=\"sendComment(post.post_id)\">\n          <input\n            type=\"text\"\n            class=\"comment_new--textarea\"\n            aria-label=\"Ajouter un commentaire...\"\n            placeholder=\"Ajouter un commentaire...\"\n            v-model.lazy=\"message\"\n          />\n          <button class=\"comment_new--btn\" type=\"submit\">\n            <font-awesome-icon icon=\"paper-plane\" />\n            Publier\n          </button>\n        </form>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport ApiService from \"../api-service\";\n\nlet moment = require(\"moment\");\nmoment.locale(\"fr\"); //Appel du module moment.js pour affichage à quel moment le message a été écris\n\nexport default {\n  name: \"Post\",\n  data() {\n    return {\n      error: [],\n      userId: localStorage.getItem(\"userId\"),\n      isAdmin: localStorage.getItem(\"isAdmin\"),\n      moment: moment,\n      posts: [],\n      comments: {},\n      showComments: {},\n      message: \"\",\n    };\n  },\n  methods: {\n    // Suppression d'un post\n    removePost(post) {\n      if (confirm(\"Êtes vous sûr de vouloir supprimer le post ?\")) {\n        ApiService.removePost(post);\n        location.reload();\n      } else {\n        return;\n      }\n    },\n    // Affichage des commentaires liés au post\n    showCommentsAction(post) {\n      this.showComments[post.post_id] = !this.showComments[post.post_id];\n      this.showComments = JSON.parse(JSON.stringify(this.showComments));\n    },\n    sendComment(postId) {\n      const message = this.message;\n      console.log(message);\n      console.log(postId);\n      ApiService.createComment(message, postId);\n      this.message = \"\";\n      location.reload();\n    },\n    removeComment(comment) {\n      if (confirm(\"Êtes vous sûr de vouloir supprimer le commentaire ?\")) {\n        ApiService.removeComment(comment);\n        location.reload();\n      } else {\n        return;\n      }\n    },\n  },\n  mounted() {\n    //Appel à API pour affichage de tous les messages\n    ApiService.getAllPost()\n      .then((response) => {\n        this.posts = response.data;\n        console.log(this.posts);\n      })\n      .catch((error) => console.log(error));\n    ApiService.getAllComment()\n      .then((response) => {\n        this.comments = response.data;\n        console.log(this.comments);\n      })\n      .catch((error) => console.log(error));\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\n.date {\n  font-size: 0.7rem;\n  color: #808080;\n  margin: 1rem 1rem 1rem 0.5rem;\n}\n\n.post {\n  max-width: 600px;\n  margin: auto;\n\n  &_title {\n    display: flex;\n    align-items: baseline;\n    margin: 1rem;\n    font-size: 0.9rem;\n\n    &--icon {\n      font-size: 1.1rem;\n      margin: 0.5rem;\n      color: #fd2d02;\n    }\n  }\n\n  .post_item {\n    border-radius: 5px;\n    background-color: #fff;\n    margin: 1rem;\n    padding: 1rem;\n    border: 1px solid #e2e2e2;\n\n    .post_header {\n      display: flex;\n      justify-content: space-between;\n      align-items: baseline;\n      border-bottom: 1px solid #e2e2e2;\n\n      &--icon {\n        margin: 0.5rem;\n        color: #808080;\n      }\n\n      &--date {\n        display: flex;\n        align-items: baseline;\n\n        &-logo {\n          color: #808080;\n          font-size: 0.7rem;\n        }\n      }\n\n      &--username {\n        font-size: 1rem;\n        flex-grow: 1;\n      }\n\n      &--btn {\n        background: none;\n        border: none;\n        color: #fd2d02;\n        font-weight: bold;\n\n        &:hover {\n          opacity: 0.6;\n          cursor: pointer;\n        }\n      }\n    }\n\n    &--content-img {\n      max-width: 100%;\n    }\n\n    &--content-txt {\n      text-align: justify;\n      padding: 1rem 0.2rem;\n    }\n\n    &--content-btn {\n      background: none;\n      border: none;\n      color: #fd2d02;\n      font-weight: bold;\n      margin: 1rem 0;\n\n      &:hover {\n        opacity: 0.6;\n        cursor: pointer;\n      }\n    }\n  }\n}\n\n.comments_wrapper {\n  padding: 0.9rem;\n\n  &--title {\n    margin: 0;\n    padding: 1rem 0;\n    font-size: 1rem;\n  }\n\n  .comment_item {\n    margin: 0.5rem 0;\n    padding: 0.5rem;\n    border-top: 0.5px solid #e2e2e2;\n\n    .comment_header {\n      display: flex;\n      justify-content: space-between;\n      align-items: baseline;\n\n      &--username {\n        font-size: 0.9rem;\n        flex-grow: 1;\n        margin: 1rem 0;\n      }\n\n      &--remove-btn {\n        background: none;\n        border: none;\n        color: #fd2d02;\n        font-weight: bold;\n\n        &:hover {\n          opacity: 0.6;\n          cursor: pointer;\n        }\n      }\n    }\n\n    .comment_content {\n      text-align: justify;\n      font-size: 0.9rem;\n    }\n  }\n}\n.comment_new {\n  display: flex;\n  justify-content: space-between;\n  border: 1px solid #e2e2e2;\n  border-radius: 5px;\n  margin: 1rem;\n\n  &--textarea {\n    resize: none;\n    border: none;\n    width: 100%;\n    padding: 0.5rem;\n\n    &:focus-visible {\n      outline: none;\n    }\n  }\n  &--btn {\n    border: none;\n    background: none;\n    color: #fd2d02;\n    font-weight: bold;\n    width: 105px;\n\n    &:hover {\n      opacity: 0.6;\n      cursor: pointer;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/components"}]}