{"remainingRequest":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/src/components/Login.vue","mtime":1627995886641},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/clothilde/Desktop/OpenClassRooms/Projet 7/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgIEFwaVNlcnZpY2UgZnJvbSAnLi4vYXBpLXNlcnZpY2UnOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogImxvZ2luIiwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZXJyb3JzOiBbXSwKICAgICAgICAgICAgdXNlcm5hbWU6IG51bGwsCiAgICAgICAgICAgIHBhc3N3b3JkOiBudWxsLAogICAgICAgICAgICBkYXRhOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpLAogICAgICAgICAgICB1c2VyOiAiIiwKICAgICAgICB9CiAgICB9LAoKICAgIG1ldGhvZHM6IHsKICAgICAgICBsb2dpbkZvcm0oZSkgewogICAgICAgICAgICB0aGlzLmVycm9ycyA9IFtdOwogICAgICAgICAgICBpZiAoIXRoaXMudXNlcm5hbWUgKSB7CiAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goJ1BzZXVkbyByZXF1aXMgIScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdGhpcy5wYXNzd29yZCkgewogICAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goJ01vdCBkZSBwYXNzZSByZXF1aXMnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRoaXMuZXJyb3JzLmxlbmd0aCkgewogICAgICAgIEFwaVNlcnZpY2UubG9naW4odGhpcy51c2VybmFtZSwgdGhpcy5wYXNzd29yZCkKICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInVzZXJJZCIsIHJlc3VsdC5kYXRhLnVzZXJJZCkKICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHJlc3VsdC5kYXRhLnRva2VuKQogICAgICAgICAgICBhbGVydCgiVm91cyDDqnRlcyDDoCBwcsOpc2VudCBjb25uZWN0w6kgISIpCiAgICAgICAgICAgIGxldCB1c2VySWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIik7CiAgICAgICAgICAgIEFwaVNlcnZpY2UuZ2V0T25lVXNlcih1c2VySWQpCiAgICAgICAgCiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgdGhpcy51c2VyID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnVzZXIpCiAgICAgICAgICAgIHRoaXMudXNlcm5hbWUgPSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcm5hbWUnLCB0aGlzLnVzZXIudXNlcm5hbWUpCiAgICAgICAgICAgIHRoaXMubm9tID0gbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ25vbScsIHRoaXMudXNlci5ub20pCiAgICAgICAgICAgIHRoaXMucHJlbm9tID0gbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3ByZW5vbScsIHRoaXMudXNlci5wcmVub20pCiAgICAgICAgICAgIHRoaXMuaXNBZG1pbiA9IGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdpc0FkbWluJywgdGhpcy51c2VyLmlzQWRtaW4pCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvcG9zdCcpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpKQogICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgIAogICAgICAgIH0sCiAgICB9Cn0KCg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n        <section id=\"login\" class=\"login\">\n            <h2>Connexion</h2>\n            <form id=\"login-form\" class=\"login_form\" @submit=\"loginForm\">\n                <div class=\"login_form--item\">\n                    <label class=\"login_form--item-label\" for=\"username\">Nom d'utilisateur</label>\n                    <input class=\"login_form--item-input\"\n                    type=\"text\"\n                    id=\"username\"\n                    v-model=\"username\">\n                </div>\n\n                <div class=\"login_form--item\">\n                    <label class=\"login_form--item-label\" for=\"password\">Mot de Passe</label>\n                    <input class=\"login_form--item-input\" \n                    type=\"password\"\n                    id=\"password\"\n                    v-model=\"password\">\n\n                </div>\n\n                <button class=\"login_form--btn\" type=\"submit\">Connexion</button>\n            </form>\n        </section>\n</template>\n\n<script>\n\nimport  ApiService from '../api-service';\n\nexport default {\n    name: \"login\",\n    data() {\n        return {\n            errors: [],\n            username: null,\n            password: null,\n            data: JSON.parse(localStorage.getItem('user')),\n            user: \"\",\n        }\n    },\n\n    methods: {\n        loginForm(e) {\n            this.errors = [];\n            if (!this.username ) {\n            this.errors.push('Pseudo requis !');\n            }\n            if (!this.password) {\n              this.errors.push('Mot de passe requis');\n            }\n            if (!this.errors.length) {\n        ApiService.login(this.username, this.password)\n            .then((result) => {\n                localStorage.setItem(\"userId\", result.data.userId)\n                localStorage.setItem(\"token\", result.data.token)\n            alert(\"Vous êtes à présent connecté !\")\n            let userId = localStorage.getItem(\"userId\");\n            ApiService.getOneUser(userId)\n        \n            .then(response => {\n            this.user = response.data\n            console.log(this.user)\n            this.username = localStorage.setItem('username', this.user.username)\n            this.nom = localStorage.setItem('nom', this.user.nom)\n            this.prenom = localStorage.setItem('prenom', this.user.prenom)\n            this.isAdmin = localStorage.setItem('isAdmin', this.user.isAdmin)\n            this.$router.push('/post');\n            })\n            .catch(error => console.log(error))\n            })\n            }\n            e.preventDefault();  \n        },\n    }\n}\n\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\nh2 {\n    text-align: center;\n}\n.login_form {\n    display: flex;\n    flex-direction: column;\n\n    &--item {\n        display: flex;\n        justify-content: center;\n        margin: .9rem;\n\n        &-label {\n            margin-right: 1rem;\n        }\n    }\n    &--btn {\n        max-width: fit-content;\n        align-self: center;\n        margin: 1.5rem;\n        background-color: #fd2d02;\n        color: #FFF;\n        border-radius: 10px;\n        border: none;\n        padding: .5rem;\n        box-shadow: 2px 3px 10px #e2e2e2;\n\n        &:hover {\n            opacity: 0.8;\n            box-shadow: 1px 1px 10px #808080;\n            cursor: pointer;\n        }\n    }\n}\n</style>\n"]}]}